[tox]
minversion = 3.14.0
ignore_basepython_conflict = true
# 
envlist =
    py310
    lint

# configures which environments run with each python version
[testenv]
basepython =
    {py3.10}: {env:TOXPYTHON:python3.10}
    {lint}: {env:TOXPYTHON:python3}
passenv = *

[testenv:py39]
setenv =
    PYTHONPATH={toxinidir}/tests
    PYTHONUNBUFFERED=yes
# userdevelop is true because HADDOCK3 is expected to be installed from the
# repository.
usedevelop = true
# installs dependencies we need for testing
# by using tox the developer don't need to manage this dependencies
# him/herself
deps =
    -r{toxinidir}/pymap.txt
    coverage
    pytest
    pytest-cov
    hypothesis
    toml
# before running the tests erases any prerecord of coverage
commands_pre =
    coverage erase
# execute pytest
commands =
    pytest --cov --cov-report=term-missing --cov-append --cov-config=.coveragerc --hypothesis-show-statistics {posargs}
# after executing the pytest assembles the coverage reports
commands_post = 
    coverage report
    coverage html
    coverage xml

[testenv:lint]
skip_install = true
deps =
    flake8>=4
    flake8-print>=5
    flake8-docstrings
    flake8-bugbear
    pygments
    isort
commands =
    flake8 {posargs:tests libclust.py libentropy.py libio.py pymap.py setup.py}
    isort --verbose --check-only --diff {posargs:tests libclust.py libentropy.py libio.py pymap.py setup.py}